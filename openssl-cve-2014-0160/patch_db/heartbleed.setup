diff --git a/apps/openssl-1.0.1/e_os.h b/apps/openssl-1.0.1/e_os.h
index 79c1392..98263f1 100644
--- a/e_os.h
+++ b/e_os.h
@@ -725,6 +725,8 @@ struct servent *getservbyname(const char *name, const char *proto);
 #include <OS.h>
 #endif
 
+// Disable effect of getpid to make RNG deterministic
+#define GETPID_IS_MEANINGLESS
 
 #ifdef  __cplusplus
 }
diff --git a/apps/openssl-1.0.1/crypto/mem_clr.c b/apps/openssl-1.0.1/crypto/mem_clr.c
index add1f78..df813e3 100644
--- a/crypto/mem_clr.c
+++ b/crypto/mem_clr.c
@@ -73,5 +73,4 @@ void OPENSSL_cleanse(void *ptr, size_t len)
 	p=memchr(ptr, (unsigned char)ctr, len);
 	if(p)
 		ctr += (63 + (size_t)p);
-	cleanse_ctr = (unsigned char)ctr;
 	}
diff --git a/apps/openssl-1.0.1/crypto/lhash/lhash.c b/apps/openssl-1.0.1/crypto/lhash/lhash.c
index 47f7480..2eca83a 100644
--- a/crypto/lhash/lhash.c
+++ b/crypto/lhash/lhash.c
@@ -122,6 +122,7 @@ _LHASH *lh_new(LHASH_HASH_FN_TYPE h, LHASH_COMP_FN_TYPE c)
	goto err1;
	for (i=0; i<MIN_NODES; i++)
		ret->b[i]=NULL;
+	__DELTA_WHITELIST_ADD(ret, sizeof(_LHASH));
	ret->comp=((c == NULL)?(LHASH_COMP_FN_TYPE)strcmp:c);
	ret->hash=((h == NULL)?(LHASH_HASH_FN_TYPE)lh_strhash:h);
	ret->num_nodes=MIN_NODES/2;
@@ -172,6 +173,7 @@ void lh_free(_LHASH *lh)
			n=nn;
			}
		}
+	__DELTA_WHITELIST_RM(lh);
	OPENSSL_free(lh->b);
	OPENSSL_free(lh);
	}
diff --git a/apps/openssl-1.0.1/crypto/rand/md_rand.c b/apps/openssl-1.0.1/crypto/rand/md_rand.c
index fcdd3f2..02a0531 100644
--- a/crypto/rand/md_rand.c
+++ b/crypto/rand/md_rand.c
@@ -136,10 +136,10 @@
 /* #define PREDICT	1 */
 
 #define STATE_SIZE	1023
-static int state_num=0,state_index=0;
-static unsigned char state[STATE_SIZE+MD_DIGEST_LENGTH];
-static unsigned char md[MD_DIGEST_LENGTH];
-static long md_count[2]={0,0};
+DELTA_WHITELIST_DEF static int state_num=0,state_index=0;
+DELTA_WHITELIST_DEF static unsigned char state[STATE_SIZE+MD_DIGEST_LENGTH];
+DELTA_WHITELIST_DEF static unsigned char md[MD_DIGEST_LENGTH];
+DELTA_WHITELIST_DEF static long md_count[2]={0,0};
 static double entropy=0;
 static int initialized=0;
