#!/bin/bash

PROC_NAME="openssl"
BIN_PATH=`pwd`/install/bin/openssl
BC_PATH=`pwd`/apps/openssl.bc
SRC_DIR="ssl"

PATCH_URL="ftp://ftp.openssl.org/source/old/1.0.1/"
PATCH_BASE_VERSION="1.0.1"
PATCH_PROG_PREFIX="openssl-"
PATCH_PROG_SUFFIX=".tar.gz"

ROOT=${LLVMAPPS_ROOT-../..}

. ${ROOT}/apps/scripts/include/cmdctl.inc

KEY=`pwd`/install/ssl/key.pem
CERT=`pwd`/install/ssl/cert.pem
SERVER_PORT=44330

mode=$1
shift || mode="no_action"

case "$mode" in
  'start')
    echo "***** Starting $PROC_NAME server..."
    cmdctl_server_check_not_running
    eval $LLVM_CMD_PREFIX $BIN_PATH s_server -key $KEY -cert $CERT -accept $SERVER_PORT $*
    ;;
  *)
    cmdctl_server_action $mode $*
    ;;
esac
